<!doctype html>

<title>gwes-mode-demo</title>
<meta charset="utf-8"/>
<link rel="stylesheet" href="lib/codemirror.css">
<link rel="stylesheet" href="addon/lint/lint.css">

<link rel="stylesheet" href="theme/3024-day.css">
<link rel="stylesheet" href="theme/3024-night.css">
<link rel="stylesheet" href="theme/abcdef.css">
<link rel="stylesheet" href="theme/ambiance.css">
<link rel="stylesheet" href="theme/base16-dark.css">
<link rel="stylesheet" href="theme/bespin.css">
<link rel="stylesheet" href="theme/base16-light.css">
<link rel="stylesheet" href="theme/blackboard.css">
<link rel="stylesheet" href="theme/cobalt.css">
<link rel="stylesheet" href="theme/colorforth.css">
<link rel="stylesheet" href="theme/dracula.css">
<link rel="stylesheet" href="theme/duotone-dark.css">
<link rel="stylesheet" href="theme/duotone-light.css">
<link rel="stylesheet" href="theme/eclipse.css">
<link rel="stylesheet" href="theme/elegant.css">
<link rel="stylesheet" href="theme/erlang-dark.css">
<link rel="stylesheet" href="theme/gruvbox-dark.css">
<link rel="stylesheet" href="theme/hopscotch.css">
<link rel="stylesheet" href="theme/icecoder.css">
<link rel="stylesheet" href="theme/isotope.css">
<link rel="stylesheet" href="theme/lesser-dark.css">
<link rel="stylesheet" href="theme/liquibyte.css">
<link rel="stylesheet" href="theme/lucario.css">
<link rel="stylesheet" href="theme/material.css">
<link rel="stylesheet" href="theme/mbo.css">
<link rel="stylesheet" href="theme/mdn-like.css">
<link rel="stylesheet" href="theme/midnight.css">
<link rel="stylesheet" href="theme/monokai.css">
<link rel="stylesheet" href="theme/neat.css">
<link rel="stylesheet" href="theme/neo.css">
<link rel="stylesheet" href="theme/night.css">
<link rel="stylesheet" href="theme/nord.css">
<link rel="stylesheet" href="theme/oceanic-next.css">
<link rel="stylesheet" href="theme/panda-syntax.css">
<link rel="stylesheet" href="theme/paraiso-dark.css">
<link rel="stylesheet" href="theme/paraiso-light.css">
<link rel="stylesheet" href="theme/pastel-on-dark.css">
<link rel="stylesheet" href="theme/railscasts.css">
<link rel="stylesheet" href="theme/rubyblue.css">
<link rel="stylesheet" href="theme/seti.css">
<link rel="stylesheet" href="theme/shadowfox.css">
<link rel="stylesheet" href="theme/solarized.css">
<link rel="stylesheet" href="theme/the-matrix.css">
<link rel="stylesheet" href="theme/tomorrow-night-bright.css">
<link rel="stylesheet" href="theme/tomorrow-night-eighties.css">
<link rel="stylesheet" href="theme/ttcn.css">
<link rel="stylesheet" href="theme/twilight.css">
<link rel="stylesheet" href="theme/vibrant-ink.css">
<link rel="stylesheet" href="theme/xq-dark.css">
<link rel="stylesheet" href="theme/xq-light.css">
<link rel="stylesheet" href="theme/yeti.css">
<link rel="stylesheet" href="theme/idea.css">
<link rel="stylesheet" href="theme/darcula.css">
<link rel="stylesheet" href="theme/yonce.css">
<link rel="stylesheet" href="theme/zenburn.css">



<script src="lib/codemirror.js"></script>
<script src="addon/mode/simple.js"></script>
<script src="gwes.js"></script>

<script src="addon/edit/matchbrackets.js"></script>
<script src="addon/edit/closebrackets.js"></script>
<script src="addon/selection/active-line.js"></script>

<script src="addon/lint/lint.js"></script>
<script src="addon/lint/gwes-lint.js"></script>




<style>
    .CodeMirror {background: #f8f8f8;}
</style>
<p>表达式demo,可任意编辑内容进行测试</p>
<p>皮肤: <select onchange="selectTheme()" id=select>
    <option>default</option>
    <option>3024-day</option>
    <option>3024-night</option>
    <option>abcdef</option>
    <option>ambiance</option>
    <option>base16-dark</option>
    <option>base16-light</option>
    <option>bespin</option>
    <option>blackboard</option>
    <option>cobalt</option>
    <option>colorforth</option>
    <option selected>darcula</option>
    <option>dracula</option>
    <option>duotone-dark</option>
    <option>duotone-light</option>
    <option>eclipse</option>
    <option>elegant</option>
    <option>erlang-dark</option>
    <option>gruvbox-dark</option>
    <option>hopscotch</option>
    <option>icecoder</option>
    <option>idea</option>
    <option>isotope</option>
    <option>lesser-dark</option>
    <option>liquibyte</option>
    <option>lucario</option>
    <option>material</option>
    <option>mbo</option>
    <option>mdn-like</option>
    <option>midnight</option>
    <option>monokai</option>
    <option>neat</option>
    <option>neo</option>
    <option>night</option>
    <option>nord</option>
    <option>oceanic-next</option>
    <option>panda-syntax</option>
    <option>paraiso-dark</option>
    <option>paraiso-light</option>
    <option>pastel-on-dark</option>
    <option>railscasts</option>
    <option>rubyblue</option>
    <option>seti</option>
    <option>shadowfox</option>
    <option>solarized dark</option>
    <option>solarized light</option>
    <option>the-matrix</option>
    <option>tomorrow-night-bright</option>
    <option>tomorrow-night-eighties</option>
    <option>ttcn</option>
    <option>twilight</option>
    <option>vibrant-ink</option>
    <option>xq-dark</option>
    <option>xq-light</option>
    <option>yeti</option>
    <option>yonce</option>
    <option>zenburn</option>
</select>
</p>
<form>
    <textarea id="code" name="code">
(姓名=张三 
	and age>55
	or 姓名='司马'韩文 
	and age>=55 to 64 and tips=这个中文括号当错误校验：（）
	xor sex=男 imag% 
	not display# ) pre
  and 户籍=%景德镇% OR title='户籍管理处'
  
 (a<=(?99) and b%!=999)
 
'单行字符串：中文括号不做处理：（）'
'跨行字符串开始：
    跨行字符串：中文括号不做处理：（）
跨行字符串结束；'
	
 title='巴黎圣母院失火' 
	and time<'2019-04-17'
	or local='法国'


</textarea>
    <div>
        <div style="display: inline-block; margin-left:20px">
            当前坐标：
            <span id="cursorPos">行：1，列：1 </span>
        </div>
        <div style="display: inline-block; margin-left:20px">
            括号统计：
            <span id="bracketCount">（ 个数： 0，) 个数： 0</span>
        </div>
    </div>
</form>
<h4>可测试功能项：</h4>
<ul>
    <li>换肤</li>
    <li>英文小括号()个数统计</li>
    <li>中文小括号（）在非字符串中校验，出现（）后，左侧边栏有错误提示，同时（）所在位置也会有错误提示</li>
    <li>关键词（and、or、xor、to、not、pre 不区分大小写)及特殊标识（?、%、#），统一按关键词，高亮显示</li>
    <li>运算符（=、>、<、>=、<=、!=）按操作符高亮显示</li>
    <li>由''包围的内容，连同''一起按字符串高亮显示</li>
    <li>长文本自动换行，但行号不变（有换行符才算行号）</li>
    <li>鼠标所在行高亮显示</li>
    <li>显示鼠标位置</li>
    <li>点击任意括号，与之匹配的高亮显示</li>


</ul>
<script>
    var gwEditor=null;
    init();
    //初始化，设置选项和事件监听
    function init() {
      gwEditor = CodeMirror.fromTextArea(document.getElementById("code"), {
        lineNumbers: true,
        mode:'gwes',
        gutters: ["CodeMirror-lint-markers"],
        lint: true,
        theme: 'darcula',

        //自动关闭括号
        autoCloseBrackets:{
          pairs: "()''",
        },
        autofocus: true,
        styleActiveLine:true,//高亮当前行
        lineWrapping: true,
        matchBrackets: true});

      gwEditor.on('cursorActivity',function (cm) {
        var pos = cm.doc.getCursor();
        document.getElementById('cursorPos').innerHTML="行："+(pos.line+1) + "，列："+(pos.ch +1);
      });

      gwEditor.on('focus',countBracket);
      gwEditor.on('changes',countBracket);
    }

    //设置主题
    function selectTheme() {
      var input = document.getElementById("select");
      var theme = input.options[input.selectedIndex].textContent;
      gwEditor.setOption("theme", theme);
    }
    //计算英文小括号的个数
  function countBracket(cm){
    var text = cm.doc.getValue();
    var leftArr = text.match(/\(/g),
        rightArr = text.match(/\)/g);

    document.getElementById('bracketCount').innerHTML="( 个数："+ (leftArr?leftArr.length:0) + "，) 个数："+((rightArr?rightArr.length:0));
  }


</script>
